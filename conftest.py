import subprocess
import pytest
import os


@pytest.fixture
def run_cli():
    def _run_cli(
        command_args, tmp_path, output_subdir="output", output_dir_arg="--out_dir"
    ):
        # Prepare the output directory
        output_dir = tmp_path / output_subdir
        output_dir.mkdir(exist_ok=True)

        # Append the output directory to the command arguments if necessary
        # This assumes your CLI accepts an '--output' argument
        if output_dir_arg not in command_args:
            command_args.extend([output_dir_arg, str(output_dir)])

        # Run the command
        result = subprocess.run(
            command_args,
            capture_output=True,
            text=True,
            cwd=tmp_path,  # Ensure the working directory is the temp path
        )

        # Check the return code
        assert result.returncode == 0, f"Command failed with error:\n{result.stderr}"

        # Collect the list of generated files
        generated_files = [f.name for f in output_dir.iterdir() if f.is_file()]

        # Optionally, you can return the output directory path for further checks
        return generated_files, output_dir

    return _run_cli


@pytest.fixture
def resource_path():
    # Fetch the resource folder path from the environment variable
    resource_dir = os.getenv("LIONHEART_RESOURCE_DIR")
    if not os.path.exists(resource_dir):
        pytest.fail(f"Resource directory does not exist: {resource_dir}")
    return resource_dir


@pytest.fixture
def lionheart_features():
    snyder_scores = [
        -0.2576,
        -1.9817,
        -0.8549,
        -0.8042,
        -1.1664,
        -0.7473,
        -0.6477,
        -0.7285,
        -0.7125,
        0.0418,
        -0.0476,
        -2.1561,
        0.7035,
        -0.2807,
        0.2764,
        0.2633,
        0.4246,
        -0.5691,
        -2.059,
        -1.3526,
        -1.9445,
        -1.8324,
        0.8924,
        -0.6013,
        -0.6344,
        -0.2109,
        -0.2112,
        0.3676,
        -1.3631,
        -1.9231,
        -0.7221,
        0.377,
        0.8329,
        0.708,
        0.4966,
        0.7798,
        0.0105,
        -0.2611,
        -0.0148,
        -0.1179,
        -0.0659,
        -0.6204,
        0.4419,
        -0.5465,
        -0.5721,
        -0.2357,
        0.2814,
        -0.0593,
        -0.0163,
        -0.0825,
        0.3493,
        0.4154,
        -0.0439,
        -0.4033,
        -0.0575,
        -0.394,
        -0.4263,
        -0.6614,
        -0.9122,
        -0.9637,
        -2.0509,
        0.0444,
        -0.3953,
        1.373,
        -0.0892,
        0.1454,
        -0.1028,
        -2.1424,
        -2.2361,
        -2.1999,
        -0.5911,
        -0.0791,
        0.4265,
        0.3085,
        0.6118,
        0.1712,
        0.7911,
        0.0371,
        0.3078,
        0.5114,
        0.1423,
        0.0016,
        0.2006,
        0.6881,
        0.3915,
        0.1052,
        0.0505,
        -0.2877,
        0.1943,
        2.4554,
        -0.7435,
        -1.49,
        -1.823,
        0.3065,
        -0.5376,
        -1.0937,
        -0.9353,
        0.0641,
        -0.0349,
        -0.7699,
        -1.6467,
        0.6723,
        -1.4509,
        0.3305,
        -0.315,
        0.1042,
        0.1786,
        0.6747,
        -0.3369,
        -0.2449,
        -0.0094,
        -0.2403,
        0.0034,
        -0.101,
        -3.1895,
        0.0298,
        0.5647,
        -0.1951,
        -0.3604,
        -0.2938,
        -1.1515,
        -1.0779,
        -1.756,
        -0.8174,
        -1.9023,
        -1.0926,
        -0.1801,
        -1.56,
        -0.9504,
        -1.6991,
        -1.8397,
        -1.8757,
        -1.4591,
        -1.4725,
        0.627,
        -0.4725,
        0.9731,
        0.4242,
        0.5113,
        -0.0493,
        0.5268,
        0.3096,
        0.8461,
        0.7746,
        -0.1393,
        1.1207,
        0.3259,
        0.5975,
        1.3263,
        1.5801,
        0.6081,
        0.8871,
        0.6607,
        -1.56,
        0.7154,
        0.5555,
        0.9569,
        0.3645,
        0.3467,
        0.302,
        0.2184,
        1.3291,
        1.2287,
        0.5009,
        0.4044,
        -0.214,
        0.0458,
        0.8365,
        0.6067,
        0.3856,
        1.4812,
        0.3516,
        0.3651,
        -1.9064,
        -1.5976,
        -2.0394,
        -1.8656,
        -1.8853,
        -1.2247,
        -1.8771,
        -1.6039,
        -1.5776,
        0.5562,
        0.6864,
        1.4881,
        0.2248,
        0.7324,
        -0.8378,
        0.541,
        0.4815,
        -1.5383,
        1.7469,
        0.1953,
        1.022,
        0.2725,
        0.5521,
        0.0514,
        0.0492,
        0.0459,
        -0.9465,
        0.857,
        -1.851,
        -2.0707,
        -2.2565,
        1.0177,
        0.4097,
        0.3865,
        0.5328,
        -0.4814,
        1.9477,
        -0.6651,
        -0.097,
        0.1502,
        1.2785,
        0.9481,
        0.581,
        3.361,
        3.231,
        0.5774,
        0.4626,
        0.2058,
        1.0546,
        0.7469,
        1.1832,
        0.9907,
        0.8767,
        0.3566,
        0.9081,
        0.8909,
        0.5823,
        0.48,
        1.0591,
        0.6519,
        0.8503,
        0.9225,
        0.0872,
        1.3087,
        0.5843,
        0.3673,
        1.5146,
        0.9224,
        0.4476,
        -0.9118,
        0.6153,
        0.4306,
        -1.494,
        -0.0929,
        -0.0226,
        0.0075,
        0.7979,
        0.6518,
        0.3227,
        -0.8443,
        -0.8757,
        -0.8187,
        -0.5894,
        -0.7256,
        0.992,
        -0.6099,
        -0.5896,
        -0.535,
        -0.6084,
        -0.729,
        -0.9443,
        -0.6517,
        -0.5668,
        -1.0975,
        0.8944,
        0.7257,
        0.4711,
        0.0731,
        -0.1834,
        2.0955,
        -0.1595,
        0.3472,
        0.4305,
        -0.9154,
        -0.5015,
        -0.1964,
        -0.4298,
        -0.8452,
        -0.3777,
        0.4911,
        -1.5602,
        -0.1426,
        0.1929,
        -0.1093,
        0.1638,
        0.3721,
        -0.126,
        -0.6669,
        -1.8432,
        0.3853,
        -0.111,
        0.3995,
        0.5383,
        -0.3131,
        -0.1574,
        -0.2695,
        -0.4916,
        -1.7906,
        0.8918,
        -0.0926,
        -0.8847,
        0.4729,
        0.4603,
        0.3825,
        0.2832,
        0.2945,
        0.4216,
        0.9066,
        0.3992,
        2.1135,
        -0.0269,
        -0.364,
        0.1189,
        -1.49,
        0.5255,
        -0.5977,
        -0.3698,
        0.4196,
        0.1323,
        0.917,
        0.3548,
        0.4161,
        0.1781,
        -0.079,
        -0.5357,
        1.2105,
        0.3337,
        -0.9106,
        0.743,
        -0.3687,
        -1.2964,
        -0.8679,
        0.0518,
        0.6205,
        0.6929,
        0.1779,
        -0.679,
        0.8461,
        -0.0298,
        2.1695,
        0.924,
        0.1649,
        -0.2107,
        0.3786,
        1.1421,
        0.4223,
        0.9779,
        0.3881,
        -0.4141,
        -2.035,
        0.2902,
        1.2974,
        1.6621,
        -0.4124,
        0.0313,
        1.1258,
        0.5272,
        0.1212,
        -0.16,
        -0.5217,
        -0.3246,
        -0.0924,
        -0.3992,
        -0.4079,
        -0.3,
        0.9319,
        1.1233,
        0.6511,
        -2.2914,
        -2.0946,
        -2.0963,
        -1.2168,
        -1.8365,
        -0.8179,
        0.9813,
        -0.028,
        -0.3964,
        -0.1677,
        -0.8844,
        0.3679,
        -0.5644,
        0.5153,
        0.3521,
        0.8909,
        -1.253,
        2.1164,
        1.5879,
        1.9457,
        -0.6693,
        -0.3054,
        0.2888,
        1.1627,
        0.4257,
        1.4694,
        0.4274,
        -0.1476,
        0.2127,
        1.4416,
        -0.6901,
        1.1645,
        0.4557,
        0.0655,
        -0.3004,
        1.153,
        0.1799,
        -0.6952,
        1.026,
        -0.6504,
        0.1065,
        1.0447,
        2.797,
        0.774,
        0.3926,
        0.6045,
        -0.9648,
        1.4217,
        -0.4155,
        -0.9244,
        -0.9885,
        0.833,
        0.4788,
        -0.4568,
        0.8045,
        -0.2078,
        0.0495,
        1.1912,
        0.5014,
        2.3005,
        0.9009,
        0.3103,
        0.6462,
        0.7846,
        0.1877,
        0.5828,
        0.7401,
        1.829,
        0.175,
        -0.0257,
        1.4352,
        0.1782,
        1.6722,
        1.5044,
        -1.1565,
        -1.6747,
        -1.6293,
        -1.0372,
        -0.7755,
        -1.3829,
        -1.1375,
        -1.297,
        -1.0402,
        0.7545,
        0.5833,
        -0.5102,
        1.1635,
        -0.541,
        0.4723,
        -1.7032,
        -1.493,
        -1.4407,
        -1.6172,
        -1.5477,
        -1.5789,
        -1.6776,
        0.8715,
        2.4132,
        -1.1604,
        0.7677,
        3.1267,
        2.8562,
        0.7891,
        -0.0647,
        1.5265,
        1.1578,
        1.2464,
        0.8536,
        0.9926,
        0.2716,
        -0.189,
        0.1528,
        -0.1381,
        1.8767,
        0.9241,
        0.1134,
        0.0884,
        -2.1008,
    ]
    return snyder_scores
